# Python入門

## 第1章の概要

この章では、ディープラーニングの実装に必要な**Pythonの基礎**を学びます。特に、科学計算ライブラリである**NumPy**と可視化ライブラリである**Matplotlib**の使い方を習得します。

---

## 1. Pythonとは

Pythonは、シンプルで読みやすい文法を持つプログラミング言語です。

### Pythonの特徴
- **シンプルな文法**：コードが読みやすく、書きやすい
- **豊富なライブラリ**：機械学習、データ分析に必要なライブラリが充実
- **インタプリタ言語**：コンパイル不要で即座に実行可能
- **オープンソース**：無料で誰でも利用可能

### データサイエンスでPythonが選ばれる理由
1. **NumPy**：高速な数値計算
2. **Pandas**：データ処理・分析
3. **Matplotlib/Seaborn**：データ可視化
4. **scikit-learn**：機械学習
5. **TensorFlow/PyTorch**：ディープラーニング

---

## 2. Pythonの基本文法

### クラス（Class）

クラスは、データ（属性）と処理（メソッド）をまとめたものです。

```python
class Man:
    def __init__(self, name):  # コンストラクタ
        self.name = name  # インスタンス変数
        print('Initialized!')
        
    def hello(self):  # メソッド
        print('Hello ' + self.name + '!')

    def goodbye(self):
        print('Goodbye ' + self.name + '!')

m = Man('Jony')  # インスタンスの生成
m.hello()        # メソッドの呼び出し
m.goodbye()
```

**重要な概念：**
- `__init__`：コンストラクタ（インスタンス生成時に自動実行）
- `self`：インスタンス自身を指す
- **インスタンス変数**：各インスタンスが持つデータ
- **メソッド**：クラス内で定義される関数

---

## 3. NumPy（ナムパイ）

**NumPy**は、Pythonで数値計算を効率的に行うためのライブラリです。ディープラーニングの実装に不可欠です。

### NumPyをインポート

```python
import numpy as np
```

### NumPy配列の作成

```python
x = np.array([1, 2, 3])
y = np.array([4, 5, 6])

print(type(x))  # <class 'numpy.ndarray'>
```

### 算術演算（要素ごとの計算）

NumPyの配列は、**要素ごと（element-wise）の演算**が可能です：

```python
x + y  # [5, 7, 9]
x * y  # [4, 10, 18]
x / y  # [0.25, 0.4, 0.5]
x - y  # [-3, -3, -3]
```

**注意点：** 配列の要素数（形状）は同じでなければならない

### N次元配列

NumPyは多次元配列を扱えます：

```python
A = np.array([[1, 2, 3], 
              [4, 5, 6]])

print(A.shape)  # (2, 3) → 2行3列
```

**形状（shape）** は配列の次元を表す重要な属性です。

### 行列の演算

```python
A = np.array([[1, 2, 3], [4, 5, 6]])
B = np.array([[4, 5, 6], [7, 8, 9]])

A + B  # [[5, 7, 9], [11, 13, 15]]
A * B  # [[4, 10, 18], [28, 40, 54]]
```

同じ形状の行列同士であれば、要素ごとに計算が行われます。

### ブロードキャスト（Broadcasting）

**ブロードキャスト**は、形状が異なる配列同士の演算を可能にする機能です：

```python
A = np.array([[1, 2], 
              [3, 4]])
B = np.array([10, 20])

A + B  # [[11, 22], [13, 24]]
A * B  # [[10, 40], [30, 80]]
```

形状が`(2, 2)`の行列と`(2,)`の1次元配列を演算可能にします。

**データサイエンスでの重要性：**
- ループを書かずに効率的な計算が可能
- コードがシンプルで読みやすくなる
- NumPyの内部最適化により高速

### 要素へのアクセス

```python
A = np.array([[1, 2], [3, 4]])

A[0]       # [1, 2] → 0行目
A[0][1]    # 2 → 0行1列の要素
```

### 配列の操作

```python
# 1次元配列に変換
AA = A.flatten()  # [1, 2, 3, 4]

# インデックスを指定して要素を取得
AA[np.array([0, 2, 3])]  # [1, 3, 4]

# 条件を満たす要素の取得（ブール値インデックス）
AA > 1  # [False, True, True, True]
AA[AA > 1]  # [2, 3, 4]
```

**ブール値インデックス**は、条件に基づいたデータの抽出に便利です。

---

## 4. Matplotlib（マットプロットリブ）

**Matplotlib**は、グラフを描画するためのライブラリです。データの可視化はデータサイエンスにおいて非常に重要です。

### Matplotlibのインポート

```python
import numpy as np
import matplotlib.pyplot as plt
```

### 単純なグラフの描画

```python
# データの作成
x = np.arange(0, 6, 0.1)  # 0から6まで0.1刻み
y = np.sin(x)

# グラフの描画
plt.plot(x, y)
plt.show()
```

### 複数のグラフを描画

```python
x = np.arange(0, 6, 0.1)
y1 = np.sin(x)
y2 = np.cos(x)

plt.plot(x, y1, label='sin(x)')
plt.plot(x, y2, linestyle='--', label='cos(x)')
plt.xlabel('x axis')            # x軸ラベル
plt.ylabel('y axis')            # y軸ラベル
plt.title('Sine and Cosine Functions')  # タイトル
plt.legend()                    # 凡例
plt.grid()                      # グリッド表示
plt.show()
```

**グラフのカスタマイズ：**
- `label`：凡例に表示される名前
- `linestyle`：線のスタイル（`'-'`, `'--'`, `'-.'`, `':'`）
- `xlabel/ylabel`：軸のラベル
- `title`：グラフのタイトル
- `legend()`：凡例の表示
- `grid()`：グリッド線の表示

---

## データサイエンスにおける重要ポイント

### 1. NumPyの重要性

**NumPyはディープラーニングの基盤**です：
- ニューラルネットワークの計算は行列演算が中心
- NumPyの配列操作を理解することが、後の実装の鍵となる
- 高速な計算により、大規模なデータ処理が可能

### 2. ベクトル化（Vectorization）

ループを使わずに配列全体を一度に処理する手法：

```python
# 遅い（Pythonのループ）
result = []
for i in range(len(x)):
    result.append(x[i] * 2)

# 速い（NumPyのベクトル化）
result = x * 2
```

**メリット：**
- コードが短く、読みやすい
- NumPyの最適化により高速
- 大規模データでパフォーマンスの差が顕著

### 3. データの可視化

**可視化はデータ理解の第一歩**です：
- データの分布や傾向を直感的に把握
- 異常値の発見
- モデルの性能評価
- 結果の説明・プレゼンテーション

### 4. 配列の形状（shape）の理解

**ディープラーニングでは形状の管理が重要**：
- 入力データ、重み、出力の形状が合わないとエラー
- `shape`を意識することで、バグを減らせる
- ブロードキャストを理解することで柔軟な実装が可能

---

## まとめ

**第1章で学んだこと：**

1. **Pythonの基本文法**
   - クラス、メソッド、インスタンス変数

2. **NumPyの基礎**
   - 配列の作成と演算
   - N次元配列と形状
   - ブロードキャスト
   - 要素のアクセスと条件抽出

3. **Matplotlibの基礎**
   - グラフの描画
   - 複数グラフの重ね合わせ
   - カスタマイズ

**次章への準備：**
これらの知識は、第2章以降のパーセプトロンやニューラルネットワークの実装に直接使われます。特にNumPyの配列操作とブロードキャストの理解が、効率的なディープラーニングの実装につながります。

---

## 参考情報

### よく使うNumPy関数

```python
np.arange(start, stop, step)  # 等差数列の生成
np.zeros(shape)               # ゼロ配列の生成
np.ones(shape)                # 1で埋められた配列
np.random.rand(shape)         # 乱数配列（0〜1の一様分布）
np.dot(A, B)                  # 行列の積（内積）
```

### NumPyとPythonのリストの違い

| 特徴 | NumPy配列 | Pythonリスト |
|------|-----------|-------------|
| 速度 | 高速 | 遅い |
| 要素の型 | 同じ型のみ | 異なる型OK |
| 演算 | ベクトル化演算 | 個別処理が必要 |
| 用途 | 数値計算 | 汎用データ構造 |

**結論：** 数値計算にはNumPy配列を使うのが標準です。
